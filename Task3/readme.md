# Задание 3. Переход на Event-Driven архитектуру.  Анализ текущей архитектуры InsureTech

![](./InsureTech_C4_сontainer-diagram_to_be-InsureTech%20To-Be.svg)
### Текущие проблемы и риски

Синхронное взаимодействия при обращении к сервису `ins-product-aggregator` инициирует несколько синхронных запросов к системам страховых компаний. Это может привести к `каскадным` задержкам, сбоям в работе сервиса при недоступности одного из сервисов страховых компаний. При увеличении количества страховых компаний проблемы только увеличатся. Опрос данных по таумауту приводит к временной неконсистентности данных, например клиенты видят неактуальные данные о тарифах. Осуществление взаиморасчетов со страховыми компаниями раз в сутки, тоже может быть не совсем удачным решением, это создает пиковую нагрузку при получении данных о оформленных страховках и операции взаиморасчета со страховыми компаниями. 

### Рекомендации по улучшению

При формировании реестра оформленных страховок в `ins-comp-settlement`  использовать `Transactional Outbox`, в связи с повышенными требованиями к консистентности данных. Переход на асинхронное взаимодействие через очереди сообщений. Использование паттерна `Публикация/Подписка`, например для получения информации о оформленных страховках. Внедрение `Event Sourcing`, например для хранения информации по продуктам и истории изменения тарифов страховых компаний.
Хранение кеша текущих тарифов.
Внедрение мониторинга работы сервисов, сбор метрик системы, в т.ч. бизнес-метрик.
Добавление централизованного логирования.
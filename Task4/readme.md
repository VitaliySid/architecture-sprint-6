# Задание 4. Проектирование продажи ОСАГО

![](./InsureTech_C4_сontainer-diagram-OSAGO.svg)


- Требуется ли ему своё хранилище данных?  
    Да, БД требуется для хранения информации по заявке на ОСАГО, хранения информации по полученным предложениям от страховых компаний. Возможно кеширование ответа от страховой компании на короткое время, при запросе данных по одному и тому же клиенту.
- Какой API он предоставляет core-app?  
    Синхронное API для создания заявки  
    Асинхронное взаимодействие для отправки предложений от страховых компаний   
- Определите средство интеграции между сервисами core-app и osago-aggregator.  
    Запрос `REST` на создание заявки  
    Публикация предложений от страховых компаний в очередь  сообщений.  
- Подумайте над API для веб-приложения в core-app.  
    - `POST /api/v1/osago/orders` - Создание заявки
    - `GET /api/v1/osago/orders/{id}` - Получение занных по заявке
    - Сообщение в очередь по преложению ОСАГО (Заявка,Стр. Компания, Данные предложения, Срок актуальности). 
    - Возможно использование протокола `STOMP` для получения преложений из очереди сразу на FRONTEND 
- Определите средство интеграции между веб-приложением и core-app. 
    - REST API
    - Websocket
    
- В зависимости от выбранных средств интеграции подумайте, требуется ли где-то применение паттернов отказоустойчивости (Rate Limiting,Circuit Breaker,Retry,Timeout).  
    Отражено на схеме. Самый очевидный пример - это отключение использования сервиса страховой комапнии на некоторое, если он недоступен или работает со сбоями.  

- Примите во внимание, что сервисы задеплоены в нескольких экземплярах. Подумайте, зависит ли ваше решение от этого.  
    Использование БД для синхронизации экземпляров сервиса. Возможно использование паттерна CQRS для отдельного масштабирования компонента API и компонента взаимодействия со страховыми компаниями.  